package project;

import javax.swing.*;
import javax.swing.border.EmptyBorder;
import java.awt.*;
import java.time.LocalDate;

public class HealthcarePanel extends JPanel {
    private JLabel characterLabel;
    private static JTextField weightField;
    private static JTextField heightField;
    private static JTextField ageField;
    private JButton backBtn;

    public HealthcarePanel() {
        setLayout(new BorderLayout(12, 12));
        setBorder(new EmptyBorder(12, 12, 12, 12));

        // 상단: 캐릭터 + 체중/키/나이 입력
        JPanel top = new JPanel(new GridLayout(1, 3, 10, 10));
        characterLabel = new JLabel("캐릭터: (미등록)", SwingConstants.CENTER);
        characterLabel.setFont(new Font("SansSerif", Font.BOLD, 18));
        top.add(characterLabel);

        weightField = new JTextField();
        weightField.setBorder(BorderFactory.createTitledBorder("몸무게 (kg)"));
        top.add(weightField);

        heightField = new JTextField();
        heightField.setBorder(BorderFactory.createTitledBorder("키 (cm)"));
        top.add(heightField);

        ageField = new JTextField();
        ageField.setBorder(BorderFactory.createTitledBorder("나이 (세)"));
        top.add(ageField);

        add(top, BorderLayout.NORTH);

        // 하단: 뒤로가기 버튼
        JPanel bottom = new JPanel(new FlowLayout(FlowLayout.CENTER, 24, 8));
        backBtn = new JButton("이전");
        bottom.add(backBtn);
        add(bottom, BorderLayout.SOUTH);

        // 중간: 운동/칼로리/수면 입력 버튼
        JPanel center = new JPanel(new GridLayout(3, 1, 12, 12));
        JButton exerciseBtn = new JButton("운동 입력");
        JButton calorieBtn = new JButton("칼로리 입력");
        JButton sleepBtn = new JButton("수면 입력");
        center.add(exerciseBtn);
        center.add(calorieBtn);
        center.add(sleepBtn);
        add(center, BorderLayout.CENTER);

        // 버튼 이벤트 (예시: 팝업 띄우기)
        exerciseBtn.addActionListener(e -> new ExerciseInputDialog((JFrame)SwingUtilities.getWindowAncestor(this)));
        calorieBtn.addActionListener(e -> new CalorieInputDialog((JFrame)SwingUtilities.getWindowAncestor(this)));
        sleepBtn.addActionListener(e -> new SleepInputDialog((JFrame)SwingUtilities.getWindowAncestor(this)));
    }

    public void setCharacterText(String text) {
        characterLabel.setText("캐릭터: " + text);
    }

    public JButton getBackButton() {
        return backBtn;
    }

    // Getter 메서드
    public static double getWeight() {
        try { return Double.parseDouble(weightField.getText()); }
        catch (Exception e) { return 0; }
    }
    public static double getHeight() {
        try { return Double.parseDouble(heightField.getText()); }
        catch (Exception e) { return 0; }
    }
    public static int getAge() {
        try { return Integer.parseInt(ageField.getText()); }
        catch (Exception e) { return 0; }
    }

    /* ---------- 내부 다이얼로그 예시 ---------- */

    private static class ExerciseInputDialog extends JDialog {
        public ExerciseInputDialog(JFrame parent) {
            super(parent, "운동 입력", true);
            setSize(400, 300);
            setLocationRelativeTo(parent);
            setLayout(new BorderLayout(10,10));

            JLabel title = new JLabel("운동 기록", SwingConstants.CENTER);
            title.setFont(new Font("SansSerif", Font.BOLD, 20));
            add(title, BorderLayout.NORTH);

            JTextField minutesField = new JTextField();
            minutesField.setBorder(BorderFactory.createTitledBorder("운동 시간 (분)"));
            add(minutesField, BorderLayout.CENTER);

            JButton okBtn = new JButton("확인");
            okBtn.addActionListener(e -> {
                JOptionPane.showMessageDialog(this, "운동 기록 저장됨: " + minutesField.getText() + "분");
                dispose();
            });
            add(okBtn, BorderLayout.SOUTH);

            setVisible(true);
        }
    }

    private static class CalorieInputDialog extends JDialog {
        public CalorieInputDialog(JFrame parent) {
            super(parent, "칼로리 입력", true);
            setSize(400, 300);
            setLocationRelativeTo(parent);
            setLayout(new BorderLayout(10,10));

            JLabel title = new JLabel("칼로리 기록", SwingConstants.CENTER);
            title.setFont(new Font("SansSerif", Font.BOLD, 20));
            add(title, BorderLayout.NORTH);

            JTextField kcalField = new JTextField();
            kcalField.setBorder(BorderFactory.createTitledBorder("칼로리 (kcal)"));
            add(kcalField, BorderLayout.CENTER);

            JButton okBtn = new JButton("확인");
            okBtn.addActionListener(e -> {
                JOptionPane.showMessageDialog(this, "칼로리 기록 저장됨: " + kcalField.getText() + " kcal");
                dispose();
            });
            add(okBtn, BorderLayout.SOUTH);

            setVisible(true);
        }
    }

    private static class SleepInputDialog extends JDialog {
        public SleepInputDialog(JFrame parent) {
            super(parent, "수면 입력", true);
            setSize(400, 300);
            setLocationRelativeTo(parent);
            setLayout(new BorderLayout(10,10));

            JLabel title = new JLabel("수면 기록", SwingConstants.CENTER);
            title.setFont(new Font("SansSerif", Font.BOLD, 20));
            add(title, BorderLayout.NORTH);

            JTextField hourField = new JTextField();
            hourField.setBorder(BorderFactory.createTitledBorder("수면 시간 (시간)"));
            add(hourField, BorderLayout.CENTER);

            JButton okBtn = new JButton("확인");
            okBtn.addActionListener(e -> {
                JOptionPane.showMessageDialog(this, "수면 기록 저장됨: " + hourField.getText() + "시간");
                dispose();
            });
            add(okBtn, BorderLayout.SOUTH);

            setVisible(true);
        }
    }
}